(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{1567:function(t,e,a){Promise.resolve().then(a.t.bind(a,4811,23)),Promise.resolve().then(a.bind(a,9064)),Promise.resolve().then(a.t.bind(a,2778,23)),Promise.resolve().then(a.bind(a,1245))},1245:function(t,e,a){"use strict";a.d(e,{AuthProvider:function(){return l},a:function(){return u}});var s=a(7437),n=a(2265),r=a(1837),c=a(9064),i=a(9376);let o=(0,n.createContext)(void 0),l=t=>{let{children:e}=t,[a,l]=(0,n.useState)(null),[u,d]=(0,n.useState)(!0),h=(0,i.useRouter)();(0,n.useEffect)(()=>{(async()=>{try{if(r.Z.isAuthenticated()){var t;let e=await r.Z.getProfile();l((null===(t=e.data)||void 0===t?void 0:t.user)||null)}}catch(t){console.error("Auth check failed:",t),await r.Z.logout()}finally{d(!1)}})()},[]);let p=async t=>{try{let e=await r.Z.login(t);l(e.data.user),c.Am.success("Welcome back!"),h.push("/dashboard")}catch(s){var e,a;let t=(null===(a=s.response)||void 0===a?void 0:null===(e=a.data)||void 0===e?void 0:e.message)||"Login failed";throw c.Am.error(t),s}},y=async t=>{try{let e=await r.Z.register(t);l(e.data.user),c.Am.success("Account created successfully!"),h.push("/dashboard")}catch(s){var e,a;let t=(null===(a=s.response)||void 0===a?void 0:null===(e=a.data)||void 0===e?void 0:e.message)||"Registration failed";throw c.Am.error(t),s}},f=async()=>{try{await r.Z.logout(),l(null),c.Am.success("Logged out successfully"),h.push("/login")}catch(t){console.error("Logout error:",t),l(null),h.push("/login")}},g=async t=>{var e,a,s;try{let a=await r.Z.updateProfile(t);l((null===(e=a.data)||void 0===e?void 0:e.user)||null),c.Am.success("Profile updated successfully")}catch(e){let t=(null===(s=e.response)||void 0===s?void 0:null===(a=s.data)||void 0===a?void 0:a.message)||"Profile update failed";throw c.Am.error(t),e}};return(0,s.jsx)(o.Provider,{value:{user:a,loading:u,login:p,register:y,logout:f,updateUser:g,isAuthenticated:!!a},children:e})},u=()=>{let t=(0,n.useContext)(o);if(!t)throw Error("useAuth must be used within an AuthProvider");return t}},1837:function(t,e,a){"use strict";var s=a(3464),n=a(4131),r=a(9064);class c{async getUsers(){return(await this.client.get("/users")).data}setTokens(t,e){this.accessToken=t,n.Z.set("accessToken",t,{expires:7,secure:!0,sameSite:"strict"}),n.Z.set("refreshToken",e,{expires:30,secure:!0,sameSite:"strict"})}clearTokens(){this.accessToken=null,n.Z.remove("accessToken"),n.Z.remove("refreshToken")}async login(t){let e=await this.client.post("/auth/login",t),{accessToken:a,refreshToken:s}=e.data.data;return this.setTokens(a,s),e.data}async register(t){let e=await this.client.post("/auth/register",t),{accessToken:a,refreshToken:s}=e.data.data;return this.setTokens(a,s),e.data}async refreshToken(t){return(await this.client.post("/auth/refresh",{refreshToken:t})).data}async logout(){try{await this.client.post("/auth/logout")}catch(t){}finally{this.clearTokens()}}async getProfile(){return(await this.client.get("/auth/profile")).data}async updateProfile(t){return(await this.client.put("/auth/profile",t)).data}async changePassword(t){return(await this.client.put("/auth/change-password",t)).data}async getProjects(t){let e=new URLSearchParams;return t&&Object.entries(t).forEach(t=>{let[a,s]=t;null!=s&&e.append(a,String(s))}),(await this.client.get("/projects?".concat(e))).data}async getProject(t){return(await this.client.get("/projects/".concat(t))).data}async createProject(t){return(await this.client.post("/projects",t)).data}async updateProject(t,e){return(await this.client.put("/projects/".concat(t),e)).data}async deleteProject(t){return(await this.client.delete("/projects/".concat(t))).data}async getProjectStats(t){return(await this.client.get("/projects/".concat(t,"/stats"))).data}async getTasks(t){let e=new URLSearchParams;return t&&Object.entries(t).forEach(t=>{let[a,s]=t;null!=s&&e.append(a,String(s))}),(await this.client.get("/tasks?".concat(e))).data}async getTask(t){return(await this.client.get("/tasks/".concat(t))).data}async createTask(t){return(await this.client.post("/tasks",t)).data}async updateTask(t,e){return(await this.client.put("/tasks/".concat(t),e)).data}async deleteTask(t){return(await this.client.delete("/tasks/".concat(t))).data}async addTaskComment(t,e){return(await this.client.post("/tasks/".concat(t,"/comments"),{comment:e})).data}async getMyTasks(t){let e=new URLSearchParams;return t&&Object.entries(t).forEach(t=>{let[a,s]=t;null!=s&&e.append(a,String(s))}),(await this.client.get("/tasks/my-tasks?".concat(e))).data}async getDashboardAnalytics(){return(await this.client.get("/analytics/dashboard")).data}async getProjectAnalytics(t,e){let a=new URLSearchParams;return t&&a.append("startDate",t),e&&a.append("endDate",e),(await this.client.get("/analytics/projects?".concat(a))).data}async getTeamAnalytics(t,e){let a=new URLSearchParams;return t&&a.append("startDate",t),e&&a.append("endDate",e),(await this.client.get("/analytics/team?".concat(a))).data}isAuthenticated(){return!!this.accessToken}getAccessToken(){return this.accessToken}constructor(){this.accessToken=null,this.client=s.Z.create({baseURL:"http://localhost:5000/api",timeout:1e4,headers:{"Content-Type":"application/json"}}),this.accessToken=n.Z.get("accessToken")||null,this.client.interceptors.request.use(t=>(this.accessToken&&(t.headers.Authorization="Bearer ".concat(this.accessToken)),t),t=>Promise.reject(t)),this.client.interceptors.response.use(t=>t,async t=>{var e,a,s,c;let i=t.config;if((null===(e=t.response)||void 0===e?void 0:e.status)===401&&!i._retry){i._retry=!0;try{let t=n.Z.get("refreshToken");if(t){let e=await this.refreshToken(t);return this.setTokens(e.data.accessToken,e.data.refreshToken),this.client(i)}}catch(t){this.logout(),window.location.href="/login"}}if((null===(a=t.response)||void 0===a?void 0:a.status)!==401){let e=(null===(c=t.response)||void 0===c?void 0:null===(s=c.data)||void 0===s?void 0:s.message)||"An error occurred";r.Am.error(e)}return Promise.reject(t)})}}let i=new c;e.Z=i},2778:function(){},4811:function(t){t.exports={style:{fontFamily:"'__Inter_f367f3', '__Inter_Fallback_f367f3'",fontStyle:"normal"},className:"__className_f367f3"}}},function(t){t.O(0,[2,610,971,117,744],function(){return t(t.s=1567)}),_N_E=t.O()}]);